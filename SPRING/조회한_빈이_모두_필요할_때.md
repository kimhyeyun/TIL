__22_02_15__

# ì¡°íšŒí•œ ë¹ˆì´ ëª¨ë‘ í•„ìš”í•  ë•Œ, List, Map
ì˜ë„ì ìœ¼ë¡œ í•´ë‹¹ íƒ€ì…ì˜ ìŠ¤í”„ë§ ë¹ˆì´ ë‹¤ í•„ìš”í•œ ê²½ìš°ê°€ ìˆìŒ  
ì˜ˆë¥¼ ë“¤ì–´ í• ì¸ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ”ë°, í´ë¼ì´ì–¸íŠ¸ê°€ í• ì¸ì˜ ì¢…ë¥˜(rate, fix)ë¥¼ ì„ íƒí•  ìˆ˜ ìˆë‹¤ê³  ê°€ì •  
ìŠ¤í”„ë§ì„ ì‚¬ìš©í•˜ë©´ ì†Œìœ„ ë§í•˜ëŠ” ì „ëµ íŒ¨í„´ì„ ë§¤ìš° ê°„ë‹¨í•˜ê²Œ êµ¬í˜„ ê°€ëŠ¥

```java
package hello.core.autowired;

import hello.core.AutoAppConfig;
import hello.core.discount.DiscountPolicy;
import hello.core.member.Grade;
import hello.core.member.Member;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationContext;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;

import java.util.List;
import java.util.Map;

import static org.assertj.core.api.Assertions.assertThat;

public class AllBeanTest {

    @Test
    void findAllBean() {
        ApplicationContext ac = new AnnotationConfigApplicationContext(AutoAppConfig.class, DiscountService.class);
        DiscountService discountService = ac.getBean(DiscountService.class);
        Member member = new Member(1L, "userA", Grade.VIP);
        int discountPrice = discountService.discount(member, 10000, "fixDiscountPolicy");

        assertThat(discountService).isInstanceOf(DiscountService.class);
        assertThat(discountPrice).isEqualTo(1000);
    }

    static class DiscountService {
        private final Map<String, DiscountPolicy> policyMap;
        private final List<DiscountPolicy> policies;

        @Autowired
        public DiscountService(Map<String, DiscountPolicy> policyMap, List<DiscountPolicy> policies) {
            this.policyMap = policyMap;
            this.policies = policies;

            System.out.println("policyMap = " + policyMap);
            System.out.println("policies = " + policies);
        }

        public int discount(Member member, int price, String discountCode) {
            DiscountPolicy discountPolicy = policyMap.get(discountCode);

            System.out.println("discountCode = " + discountCode);
            System.out.println("discountPolicy = " + discountPolicy);

            return discountPolicy.discount(member, price);
        }
    }
}

```

### ë¡œì§ ë¶„ì„
- DiscountServiceëŠ” Mapìœ¼ë¡œ ëª¨ë“  `DiscountPolicy`ë¥¼ ì£¼ì…ë°›ìŒ. ì´ë•Œ `fixDiscountPolicy`, `rateDiscountPolicy`ê°€ ì£¼ì…ë¨
- `discount()`ë©”ì„œë“œëŠ” discountCodeë¡œ "fixDiscountPolicy"ê°€ ë„˜ì–´ì˜¤ë©´ mapì— "fixDiscountPolicy" ìŠ¤í”„ë§ ë¹ˆì„ ì°¾ì•„ì„œ ì‹¤í–‰. ë¬¼ë¡  "rateDiscountPolicy"ê°€ ë„˜ì–´ì˜¤ë©´ `rateDiscountPolicy` ìŠ¤í”„ë§ ë¹ˆì„ ì°¾ì•„ì„œ ì‹¤í–‰

### ì£¼ì… ë¶„ì„
- `Map<String, DiscoutPolicy>` : mapì˜ í‚¤ì— ìŠ¤í”„ë§ ë¹ˆì˜ ì´ë¦„ì„ ë„£ì–´ì£¼ê³ , ê·¸ ê°’ìœ¼ë¡œ `DiscountPolicy` íƒ€ì…ìœ¼ë¡œ ì¡°íšŒí•œ ëª¨ë“  ìŠ¤í”„ë§ ë¹ˆì„ ë‹´ì•„ì¤Œ
- `List<DiscountPolicy>` : `DiscountPolicy` íƒ€ì…ìœ¼ë¡œ ì¡°íšŒí•œ ëª¨ë“  ìŠ¤í”„ë§ ë¹ˆì„ ë‹´ì•„ì¤€ë‹¤.
- ë§Œì•½ í•´ë‹¹í•˜ëŠ” íƒ€ì…ì˜ ìŠ¤í”„ë§ ë¹ˆì´ ì—†ìœ¼ë©´, ë¹ˆ ì»¬ë ‰ì…˜ì´ë‚˜ Mapì„ ì£¼ì…

ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ìƒì„±ìì— í´ë˜ìŠ¤ ì •ë³´ë¥¼ ë°›ëŠ”ë‹¤. ì—¬ê¸°ì— í´ë˜ìŠ¤ ì •ë³´ë¥¼ ë„˜ê¸°ë©´ í•´ë‹¹ í´ë˜ìŠ¤ê°€ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡ëœë‹¤.
![img_87.png](img_87.png)

ì´ ì½”ë“œëŠ” 2ê°€ì§€ë¡œ ë‚˜ëˆ„ì–´ ì´í•´í•  ìˆ˜ ìˆìŒ
- `new AnnotationConfigApplicationContext()`ë¥¼ í†µí•´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±
- `AutoAppConfig.class`, `DiscountService.class`ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê¸°ë©´ì„œ í•´ë‹¹ í´ë˜ìŠ¤ë¥¼ ìë™ìœ¼ë¡œ  ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•¨

ì •ë¦¬ ğŸ‘‰ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•˜ë©´ì„œ, í•´ë‹¹ ì»¨í…Œì´ë„ˆì— ë™ì‹œì— `AutoAppConfig`, `DiscountService`ë¥¼ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡